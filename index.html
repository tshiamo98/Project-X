<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boutique Bliss | Feminine Ecommerce</title>
    
    <!-- Base styles -->
    <link rel="stylesheet" href="colors.css">
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="layout.css">
    
    <!-- Component styles -->
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="buttons.css">
    <link rel="stylesheet" href="auth.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- App scripts (defer for proper loading order) -->
    <script src="firebaseConfig.js" defer></script>
    <script src="auth.js" defer></script>
    <script src="uiAuth.js" defer></script>
    <script src="main.js" defer></script>
</head>
<body>
    <!-- Header with Auth Controls -->
    <header class="main-header" role="banner">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>Boutique Bliss</h1>
                    <p class="tagline">Feminine Finds & Delightful Designs</p>
                </div>
                
                <!-- Main Navigation -->
                <nav class="main-nav" aria-label="Main navigation">
                    <ul class="nav-list" style="display: flex; gap: 2rem; align-items: center;">
                        <li><a href="index.html" class="active">Home</a></li>
                        <li><a href="products.html">Products</a></li>
                        <li><a href="cart.html" class="cart-link">
                            üõí Cart <span id="cartCount" class="count-badge" style="display: none;">0</span>
                        </a></li>
                        <li><a href="favorites.html" class="favorites-link">
                            ‚ù§Ô∏è Favorites <span id="favoritesCount" class="count-badge" style="display: none;">0</span>
                        </a></li>
                    </ul>
                </nav>
                
                <!-- Auth Navigation -->
                <nav class="auth-nav" aria-label="Authentication">
                    <div class="auth-buttons" id="authButtons">
                        <!-- Buttons will be dynamically inserted by JavaScript -->
                        <span class="auth-loading">Loading authentication...</span>
                    </div>
                    
                    <!-- User Info (hidden by default) -->
                    <div class="user-info hidden" id="userInfo">
                        <span class="user-email" id="userEmail"></span>
                        <button class="btn btn-logout" id="logoutBtn">Logout</button>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" role="main">
        <section class="hero">
            <div class="hero-content">
                <h2>Welcome to Boutique Bliss</h2>
                <p class="hero-subtitle">Your destination for beautiful, feminine fashion and accessories</p>
                
                <!-- Dynamic greeting based on auth state -->
                <div class="auth-message" id="authMessage">
                    <p>Please sign in or create an account to get started.</p>
                </div>
                
                <!-- Call to Action Buttons -->
                <div class="cta-buttons">
                    <button class="btn btn-primary" id="showLoginBtn">Login</button>
                    <button class="btn btn-secondary" id="showSignupBtn">Sign Up</button>
                    <a href="products.html" class="btn btn-success">
                        üõçÔ∏è Shop Now
                    </a>
                </div>
            </div>
            
            <!-- Colorful decorative elements -->
            <div class="hero-decoration">
                <div class="decoration-circle circle-1"></div>
                <div class="decoration-circle circle-2"></div>
                <div class="decoration-circle circle-3"></div>
            </div>
        </section>

        <!-- Info Section -->
        <section class="info-section">
            <div class="info-card">
                <div class="info-icon">üå∏</div>
                <h3>Feminine Style</h3>
                <p>Curated collection of beautiful, feminine pieces</p>
            </div>
            <div class="info-card">
                <div class="info-icon">üíú</div>
                <h3>Quality First</h3>
                <p>Premium materials and careful craftsmanship</p>
            </div>
            <div class="info-card">
                <div class="info-icon">‚ú®</div>
                <h3>Easy Shopping</h3>
                <p>Simple, intuitive shopping experience</p>
            </div>
        </section>
        
        <!-- Featured Products Preview -->
        <section class="featured-products" style="margin-top: 4rem; padding-top: 3rem; border-top: 2px solid var(--border-color);">
            <h2 style="text-align: center; margin-bottom: 1rem;">Featured Products</h2>
            <p style="text-align: center; color: var(--color-gray); margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
                Discover our most popular feminine finds
            </p>
            
            <div id="featuredProducts" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                <!-- Featured products will be loaded by JavaScript -->
                <div class="product-card-placeholder" style="background: var(--color-light); border-radius: 1rem; padding: 2rem; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">üëó</div>
                    <p style="color: var(--color-gray);">Loading featured products...</p>
                </div>
            </div>
            
            <div style="text-align: center;">
                <a href="products.html" class="btn btn-primary" style="padding: 1rem 2rem; font-size: 1.1rem;">
                    View All Products ‚Üí
                </a>
            </div>
        </section>
        
        <!-- Features -->
        <section class="features" style="margin-top: 4rem; padding: 3rem; background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light)); border-radius: 1.5rem;">
            <h2 style="text-align: center; color: var(--color-white); margin-bottom: 2rem;">Why Choose Boutique Bliss?</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 1rem; text-align: center;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">‚ù§Ô∏è</div>
                    <h3 style="margin-bottom: 0.5rem;">Save Favorites</h3>
                    <p style="color: var(--color-gray);">Create wishlists and save items you love</p>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 1rem; text-align: center;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üõí</div>
                    <h3 style="margin-bottom: 0.5rem;">Smart Cart</h3>
                    <p style="color: var(--color-gray);">Save cart items across devices</p>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 1rem; text-align: center;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üîí</div>
                    <h3 style="margin-bottom: 0.5rem;">Secure Checkout</h3>
                    <p style="color: var(--color-gray);">Safe and encrypted payments</p>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 1rem; text-align: center;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üöö</div>
                    <h3 style="margin-bottom: 0.5rem;">Fast Shipping</h3>
                    <p style="color: var(--color-gray);">Free shipping on orders over $50</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Auth Modal (hidden by default) -->
    <div class="modal-overlay hidden" id="authModal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 id="modalTitle">Authentication</h2>
                <button class="modal-close" id="closeModalBtn" aria-label="Close modal">√ó</button>
            </div>
            <div class="modal-content">
                <!-- Auth form will be dynamically inserted here -->
                <div id="authFormContainer"></div>
                
                <!-- Error display -->
                <div class="error-message hidden" id="authError"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="main-footer" role="contentinfo">
        <div class="container">
            <p>¬© 2024 Boutique Bliss. All rights reserved.</p>
            <p class="footer-note">Phase 2: Product Catalog & Shopping Experience</p>
            <div style="margin-top: 1rem; display: flex; gap: 1.5rem; justify-content: center;">
                <a href="index.html" style="color: var(--color-white);">Home</a>
                <a href="products.html" style="color: var(--color-white);">Products</a>
                <a href="cart.html" style="color: var(--color-white);">Cart</a>
                <a href="favorites.html" style="color: var(--color-white);">Favorites</a>
            </div>
        </div>
    </footer>

    <!-- Quick View Modal Container -->
    <div id="quickViewModal" class="hidden"></div>

    <!-- Additional Scripts for Home Page -->
    <script src="products.js" defer></script>
    <script src="uiProducts.js" defer></script>
    <script src="cart.js" defer></script>
    
    <script>
        // Load featured products on home page
        document.addEventListener('DOMContentLoaded', () => {
            // Wait for products module to load
            setTimeout(() => {
                loadFeaturedProducts();
                updateCartAndFavoritesCounts();
                
                // Listen for updates
                document.addEventListener('cartUpdated', updateCartAndFavoritesCounts);
                document.addEventListener('favoritesUpdated', updateCartAndFavoritesCounts);
            }, 1000);
        });
        
        function loadFeaturedProducts() {
            const allProducts = window.productModule?.getAllProducts();
            if (!allProducts || allProducts.length === 0) return;
            
            // Take first 4 products as featured
            const featuredProducts = allProducts.slice(0, 4);
            const container = document.getElementById('featuredProducts');
            
            if (container && featuredProducts.length > 0) {
                container.innerHTML = featuredProducts.map(product => `
                    <div class="product-card" style="background: var(--color-white); border-radius: 1rem; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
                        <div style="position: relative; aspect-ratio: 1/1; overflow: hidden;">
                            <img src="${product.images[0]}" 
                                 alt="${product.name}" 
                                 style="width: 100%; height: 100%; object-fit: cover;">
                            <div style="position: absolute; top: 1rem; right: 1rem;">
                                <button class="quick-action-btn favorite-btn" 
                                        data-product-id="${product.id}"
                                        onclick="handleHomeFavorite('${product.id}', this)"
                                        style="width: 2.5rem; height: 2.5rem; border-radius: 50%; background: var(--color-white); border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                    ü§ç
                                </button>
                            </div>
                        </div>
                        <div style="padding: 1.5rem;">
                            <div style="font-size: 0.85rem; color: var(--color-secondary); font-weight: 600; margin-bottom: 0.5rem;">
                                ${product.category}
                            </div>
                            <h3 style="font-size: 1.1rem; margin-bottom: 0.75rem; line-height: 1.4;">
                                <a href="products.html" style="color: inherit; text-decoration: none;">
                                    ${product.name}
                                </a>
                            </h3>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem;">
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--color-primary-dark);">
                                    $${product.price.toFixed(2)}
                                </div>
                                <button class="btn btn-primary" 
                                        onclick="handleHomeAddToCart('${product.id}')"
                                        style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function handleHomeFavorite(productId, button) {
            if (!window.productModule) return;
            
            window.productModule.toggleFavorite(productId);
            const isFavorite = window.productModule.isFavorite(productId);
            
            button.innerHTML = isFavorite ? '‚ù§Ô∏è' : 'ü§ç';
            
            if (isFavorite) {
                window.productUI?.showToast('Added to favorites!', 'success');
            } else {
                window.productUI?.showToast('Removed from favorites', 'info');
            }
        }
        
        function handleHomeAddToCart(productId) {
            if (!window.productModule) return;
            
            const success = window.productModule.addToCart(productId, 1);
            if (success) {
                window.productUI?.showToast('Added to cart!', 'success');
            }
        }
        
        function updateCartAndFavoritesCounts() {
            const cartTotal = window.productModule?.getCartTotal();
            const favorites = window.productModule?.state.favorites || [];
            
            const cartCount = document.getElementById('cartCount');
            if (cartCount && cartTotal) {
                cartCount.textContent = cartTotal.itemCount;
                cartCount.style.display = cartTotal.itemCount > 0 ? 'inline-block' : 'none';
            }
            
            const favCount = document.getElementById('favoritesCount');
            if (favCount) {
                favCount.textContent = favorites.length;
                favCount.style.display = favorites.length > 0 ? 'inline-block' : 'none';
            }
        }
    </script>
</body>
</html>