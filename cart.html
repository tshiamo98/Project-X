<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart | Boutique Bliss</title>
    
    <!-- Core Styles -->
    <link rel="stylesheet" href="colors.css">
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="layout.css">
    <link rel="stylesheet" href="buttons.css">
    
    <!-- Component Styles -->
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="forms.css">
    <link rel="stylesheet" href="cart.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Header with Navigation -->
    <header class="main-header" role="banner">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1><a href="index.html" style="text-decoration: none; color: inherit;">Boutique Bliss</a></h1>
                    <p class="tagline">Feminine Finds & Delightful Designs</p>
                </div>
                
                <!-- Main Navigation -->
                <nav class="main-nav" aria-label="Main navigation">
                    <ul class="nav-list" style="display: flex; gap: 2rem; align-items: center;">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="products.html">Products</a></li>
                        <li><a href="cart.html" class="active">
                            üõí Cart <span id="cartCount" class="count-badge" style="display: none;">0</span>
                        </a></li>
                        <li><a href="favorites.html">
                            ‚ù§Ô∏è Favorites <span id="favoritesCount" class="count-badge" style="display: none;">0</span>
                        </a></li>
                    </ul>
                </nav>
                
                <!-- Auth Navigation -->
                <nav class="auth-nav" aria-label="Authentication">
                    <div class="auth-buttons" id="authButtons">
                        <span class="auth-loading">Loading...</span>
                    </div>
                    <div class="user-info hidden" id="userInfo">
                        <span class="user-email" id="userEmail"></span>
                        <button class="btn btn-logout" id="logoutBtn">Logout</button>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" role="main">
        <!-- Page Header -->
        <section class="page-header">
            <h1>Your Shopping Cart</h1>
            <p class="page-subtitle">
                Review your items and proceed to checkout
            </p>
        </section>

        <!-- Cart Tabs -->
        <div class="list-tabs">
            <button class="list-tab active" data-tab="cart">
                üõí Shopping Cart
                <span id="cartTabCount" class="list-tab-count">0</span>
            </button>
            <button class="list-tab" data-tab="favorites">
                ‚ù§Ô∏è Favorites
                <span id="favoritesTabCount" class="list-tab-count">0</span>
            </button>
        </div>

        <!-- Lists Container -->
        <div class="lists-container">
            <!-- Cart Items -->
            <div class="list-items" id="cartItems">
                <!-- Empty State -->
                <div class="empty-state" id="cartEmptyState">
                    <div class="empty-state-icon">üõí</div>
                    <h3>Your cart is empty</h3>
                    <p>Add some beautiful items to get started!</p>
                    <a href="products.html" class="btn btn-primary">
                        Browse Products
                    </a>
                </div>
                
                <!-- Cart Items List -->
                <div id="cartItemsList" class="hidden">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                
                <!-- Clear Cart Button (only shown when cart has items) -->
                <div id="cartActions" class="hidden" style="margin-top: 2rem; text-align: center;">
                    <button id="clearCartBtn" class="btn btn-secondary">
                        üóëÔ∏è Clear Entire Cart
                    </button>
                </div>
            </div>

            <!-- Cart Summary -->
            <div class="list-summary">
                <div class="summary-section">
                    <h3>Order Summary</h3>
                    
                    <div class="summary-item">
                        <span class="summary-label">Subtotal</span>
                        <span class="summary-value" id="cartSubtotal">$0.00</span>
                    </div>
                    
                    <div class="summary-item hidden" id="savingsRow">
                        <span class="summary-label">Savings</span>
                        <span class="summary-value" id="cartSavings">-$0.00</span>
                    </div>
                    
                    <div class="summary-item">
                        <span class="summary-label">Shipping</span>
                        <span class="summary-value" id="cartShipping">FREE</span>
                    </div>
                    
                    <div class="summary-item">
                        <span class="summary-label">Tax (8%)</span>
                        <span class="summary-value" id="cartTax">$0.00</span>
                    </div>
                    
                    <div class="summary-item hidden" id="promoRow">
                        <span class="summary-label">Promo Discount</span>
                        <span class="summary-value" id="promoDiscount">-$0.00</span>
                    </div>
                    
                    <div class="summary-item" style="margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--border-color);">
                        <span class="summary-label" style="font-size: 1.1rem;">Total</span>
                        <span class="summary-total" id="cartTotal">$0.00</span>
                    </div>
                </div>
                
                <!-- Promo Code -->
                <div class="summary-section">
                    <h3>Promo Code</h3>
                    <div class="promo-code">
                        <input type="text" 
                               id="promoCode" 
                               class="promo-input" 
                               placeholder="Enter code"
                               maxlength="20">
                        <button class="apply-promo-btn">Apply</button>
                    </div>
                    <p style="font-size: 0.85rem; color: var(--color-gray); margin-top: 0.5rem;">
                        Try: WELCOME10, SUMMER25, FREESHIP
                    </p>
                </div>
                
                <!-- Summary Actions -->
                <div class="summary-actions">
                    <button class="summary-action-btn checkout-btn">
                        <span>üõí</span>
                        Proceed to Checkout
                    </button>
                    <a href="products.html" class="summary-action-btn continue-shopping-btn">
                        <span>‚Üê</span>
                        Continue Shopping
                    </a>
                </div>
                
                <!-- Security Info -->
                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--color-light); border-radius: 0.75rem;">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                        <span style="font-size: 1.25rem;">üîí</span>
                        <span style="font-weight: 600; font-size: 0.9rem;">Secure Checkout</span>
                    </div>
                    <p style="font-size: 0.85rem; color: var(--color-gray); margin: 0;">
                        Your payment information is encrypted and secure.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Shipping Information -->
        <section class="info-section" style="margin-top: 3rem; padding: 2rem; background: var(--color-light); border-radius: 1rem;">
            <h2 style="text-align: center; margin-bottom: 1.5rem;">Shipping Information</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üöö</div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">Free Shipping</h3>
                    <p style="color: var(--color-gray); font-size: 0.9rem;">
                        Free standard shipping on orders over $50
                    </p>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">‚Ü©Ô∏è</div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">Easy Returns</h3>
                    <p style="color: var(--color-gray); font-size: 0.9rem;">
                        30-day return policy. No questions asked.
                    </p>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üìû</div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem;">Customer Support</h3>
                    <p style="color: var(--color-gray); font-size: 0.9rem;">
                        Need help? Contact our support team 24/7
                    </p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer" role="contentinfo">
        <div class="container">
            <p>¬© 2024 Boutique Bliss. All rights reserved.</p>
            <p class="footer-note">Phase 2: Product Catalog & Shopping Experience</p>
            <div style="margin-top: 1rem; display: flex; gap: 1.5rem; justify-content: center;">
                <a href="index.html" style="color: var(--color-white);">Home</a>
                <a href="products.html" style="color: var(--color-white);">Products</a>
                <a href="cart.html" style="color: var(--color-white);">Cart</a>
                <a href="favorites.html" style="color: var(--color-white);">Favorites</a>
            </div>
        </div>
    </footer>

    <!-- Auth Modal (hidden by default) -->
    <div class="modal-overlay hidden" id="authModal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 id="modalTitle">Authentication</h2>
                <button class="modal-close" id="closeModalBtn" aria-label="Close modal">√ó</button>
            </div>
            <div class="modal-content">
                <div id="authFormContainer"></div>
                <div class="error-message hidden" id="authError"></div>
            </div>
        </div>
    </div>

    <!-- Quick View Modal Container -->
    <div id="quickViewModal" class="hidden"></div>

    <!-- App Scripts -->
    <script src="firebaseConfig.js"></script>
    <script src="errorHandler.js"></script>
    <script src="helpers.js"></script>
    <script src="auth.js"></script>
    <script src="uiAuth.js"></script>
    <script src="products.js"></script>
    <script src="uiProducts.js"></script>
    <script src="cart.js"></script>
    <script src="main.js"></script>

    <script>
        // Initialize cart page
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize cart module
            if (window.cartModule) {
                window.cartModule.initCart();
            }
            
            // Update tab counts
            updateTabCounts();
            
            // Listen for updates
            document.addEventListener('cartUpdated', updateTabCounts);
            document.addEventListener('favoritesUpdated', updateTabCounts);
        });
        
        // Update tab counts
        function updateTabCounts() {
            const cartTotal = window.productModule?.getCartTotal();
            const favorites = window.productModule?.state.favorites || [];
            
            // Update cart tab count
            const cartTabCount = document.getElementById('cartTabCount');
            if (cartTabCount && cartTotal) {
                cartTabCount.textContent = cartTotal.itemCount;
            }
            
            // Update favorites tab count
            const favTabCount = document.getElementById('favoritesTabCount');
            if (favTabCount) {
                favTabCount.textContent = favorites.length;
            }
            
            // Update header counts
            const cartCount = document.getElementById('cartCount');
            if (cartCount && cartTotal) {
                cartCount.textContent = cartTotal.itemCount;
                cartCount.style.display = cartTotal.itemCount > 0 ? 'inline-block' : 'none';
            }
            
            const favCount = document.getElementById('favoritesCount');
            if (favCount) {
                favCount.textContent = favorites.length;
                favCount.style.display = favorites.length > 0 ? 'inline-block' : 'none';
            }
        }
    </script>
</body>
</html>